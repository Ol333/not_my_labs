---
title: "C. Лабораторная работа №4"
summary: Вложенные циклы
description: Вложенные циклы
draft: false
math: true
weight: 4
robotsNoIndex: true
---

### Задания для самостоятельного выполнения

1. Изучить тоеретическую справку по методу средних прямоугольников и правилу Рунге.
2. Используя свой вариант и наработки по лабораторной работе №3, напишите программу для расчёта приближённого значения интеграла \\( I = \int_a^b f(x) dx \\) по формуле средних прямоугольников с заданной точностью по правилу Рунге.


### Требования и ограничения

Требуемую точность вводить с клавиатуры. Значение, рассчитанное программой, должно приближаться к контрольному значению.

### Теоретическая справка

#### Метод средних прямоугольников

В случаях, когда при вычислении интерграла \\( I = \int_a^b f(x) dx \\) невозможно найти или очень сложно вычислить первообразную, обращаются к численному интегрированию. Рассмотрим на примере метода средних прямоугольников, в котором площадь подынтегральной трапеции заменяется площадью совокупности прямоугольников.

Метод средних прямоугольников без разбиений отрезка интегрирования и с разбиением на 4 части:
{{< svg "static/images/c_lab04.svg" >}}

Без разбиений интеграл \\( I \\) можно найти в виде площади прямоугольника с шириной, равной длине интервала интегрирования \\( [a, b] \\) и высотой, равной значению \\( f(x) \\) в середине этого интервала:

$$ \int_a^b f(x) dx \approx (b-a) f \Big( \frac{a+b}{2} \Big). $$

Введём равномерную сетку \\( x_i = a + ih, i = 0,1, ..., n \\), где \\( h = \frac{b-a}{n} \\) - шаг сетки. Тогда интеграл \\( I \\) найдём как сумму площадей прямоугольников шириной \\( h \\) и высотой, равной значению \\( f(x) \\) в средней точке каждого прямоугольника:

$$ \int_a^b f(x) dx \approx h \sum_{i=0}^{n-1} f \Big( x_i + \frac{h}{2} \Big). $$

#### Правило Рунге

Правило Рунге служит для оценки погрешности численных методов. Сформулируем это правило для метода средних прямоугольников. Для поиска интеграла с заданной точностью \\( ε \\):
1. Найти интеграл с числом шагов, равным \\( n \\).
2. Найти интеграл с числом шагов, равным \\( 2n \\).
3. Вычислить величину \\( \Delta_{2n} = \frac{I_{2n} - I_n}{3} \\).
4. Если \\( \Delta_{2n} \lt ε \\) - закончить. Иначе - принять \\( n = 2n \\) и перейти к шагу 2.

### Варианты заданий

1. \\( f(x) = \begin{cases} \cos(x+x^3), & 0 \le x \le 1; \\\  e^{-x^2} - x^2 + 2x, & 1 \lt x \le 2.  \end{cases} \\)  
Контрольное значение интеграла: 1,43537.
2. \\( f(x) = \begin{cases} e^{\sin x}, & 0 \le x \le \frac{1}{4}; \\\  e^x - \frac{1}{\sqrt{x}}, & \frac{1}{4} \lt x \le \frac{1}{2}.  \end{cases} \\)  
Контрольное значение интеграла: 0,23431.
3. \\( f(x) = \begin{cases} \cos(x)e^{-x^2}, & 0 \le x \le 1; \\\  \ln(x+1) - \sqrt{4-x^2}, & 1 \lt x \le 2.  \end{cases} \\)  
Контрольное значение интеграла: 0,33735.
4. \\( f(x) = \begin{cases} \sqrt{x+1} - \sqrt{x} - \frac{1}{2}, & 0 \le x \le 1; \\\  e^{-x-\frac{1}{x}}, & 1 \lt x \le 2.  \end{cases} \\)  
Контрольное значение интеграла: 0,16514.
5. \\( f(x) = \begin{cases} 2^x - 2 + x^2, & 0 \le x \le \frac{\pi}{2}; \\\  \sqrt{x}e^{-x^2}, & \frac{\pi}{2} \lt x \le \pi.  \end{cases} \\)  
Контрольное значение интеграла: 1,02481.
6. \\( f(x) = \begin{cases} 8x^3 \cos x, & 0 \le x \le 1; \\\  \ln (1 + \sqrt{x}) - \cos x, & 1 \lt x \le 2.  \end{cases} \\)  
Контрольное значение интеграла: 2,10167.
7. \\( f(x) = \begin{cases} e^{-2\sin x}, & -1 \le x \le 1; \\\ x^2 - \ctg x, & 1 \lt x \le 2.  \end{cases} \\)  
Контрольное значение интеграла: 5,52399.
8. \\( f(x) = \begin{cases} \frac{1}{1+25x^2}, & 0 \le x \le 0,6; \\\  (x + 2x^4) \sin x^2, & 0.6 \lt x \le 1.6.  \end{cases} \\)  
Контрольное значение интеграла: 4,60078.
9. \\( f(x) = \begin{cases} (x^2 - 2x^3) \cos x^2, & -\frac{\pi}{2} \le x \le 0; \\\ e^{\sin 2x}, & 0 \lt x \le \frac{\pi}{2}.  \end{cases} \\)  
Контрольное значение интеграла: 2,93972.
10. \\( f(x) = \begin{cases} -\cos e^x, & 0 \le x \le 1; \\\ \ln (2x + \sin x^2), & 1 \lt x \le 2.  \end{cases} \\)  
Контрольное значение интеграла: 1,37207.
11. \\( f(x) = \begin{cases} x^2 \arctg x, & 0 \le x \le 1; \\\ \sin \frac{1}{x^2}, & 1 \lt x \le 2.  \end{cases} \\)  
Контрольное значение интеграла: 0,67927.
12. \\( f(x) = \begin{cases} x^2 \sin (\sqrt[3]{x} - 3), & -2 \le x \le 0; \\\ \sqrt{x} \cos 2x, & 0 \lt x \le 1.  \end{cases} \\)  
Контрольное значение интеграла: 2,42417.
